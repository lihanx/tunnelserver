# 代理池 + 隧道服务 (Golang 实现)

## 实现方案

- goroutine-per-connection 的连接处理模式；
- 基于 `select` 和 `time` 的代理池定时更新；
- 基于 `io.Copy` 的零拷贝数据传输；


## 存在的问题

1. 稳定性与客户端直连代理基本相同，但仍有配置运行耗时增加10s左右的情况；
2. “客户端-隧道服务”、“隧道服务-代理” 间的超时关系需要进一步分析；
3. 代理连接未复用；


## 待完成

- [ ] 代理连接池


## 正在进行

- [ ] 使用 OCR处理机测试，配置耗时增加似乎和OCR处理机带宽情况有关，更换 128.141 测试机进行测试；





## 测试记录

| 配置ID | 代理类型     | 任务数 | 平均耗时(s)                           | 失败率(%)                        | 均值                             |
| ------ | ------------ | ------ | ------------------------------------- | -------------------------------- | -------------------------------- |
| 116013 | 直连代理     | 20     | 20.7 / 20.6 / 21.35  / 20.05 / 20.85  | 1.04 / 1.03 / 1.07 / 1.00 / 1.04 | 20.71s / 1.04%                   |
|        |              | 50     | 23.7 / 22.75 / 23.55 / 26.35 / 22.5   | 1.19 / 1.14 / 1.18 / 1.32 / 1.13 | 23.77s / 1.19%                   |
|        |              | 100    | 25.95 / 30.45 / 28.4 / 25.2 / 25.55   | 1.30 / 1.52 / 1.42 / 1.26 / 1.28 | 27.11s / 1.36%                   |
| 116013 | 隧道代理服务 | 20     | 28.75 / 24.8 / 21.6 / 23.3 / 27.3     | 1.43 / 1.24 / 1.08 / 1.17 / 1.37 | 25.15s / 1.26% (+4.44s / +0.22%) |
|        |              | 50     | 30.35 / 33.35 / 33.75 / 34.45 / 34.75 | 1.52 / 1.67 / 1.69 / 1.72 / 1.74 | 33.33s / 1.67% (+9.56s / +0.48%) |
|        |              | 100    | 33.85 / 34.85 / 35.9 / 33.8 / 35.2    | 1.69 / 1.74 / 1.80 / 1.69 / 1.76 | 34.72s / 1.73% (+7.61s / +0.37%) |

> 1. 测试环境 : 192.168.128.141 测试机
> 2. 网站： 抖音
> 3. 测试 5 次，计算平均值；
> 4. 失败率中包含反爬导致的空数据，可参考对比增量；

